<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Run</title>
<link rel="stylesheet" href="./static/style.css"/>
</head>
<body>

<div class="card">
  <h2 id="question">Listen and choose the emotion</h2>

  <button id="playBtn">Play stimulus</button>

  <div class="row5">
    <button class="choice" data-e="Amusement">Amusement</button>
    <button class="choice" data-e="Anger">Anger</button>
    <button class="choice" data-e="Sadness">Sadness</button>
    <button class="choice" data-e="Fear">Fear</button>
    <button class="choice" data-e="Surprise">Surprise</button>
  </div>
</div>

<script>
const participant = localStorage.getItem("participant_id");

// 예시 stimulus (나중에 192개로 확장)
const stimuli = [
  "amu_F545.wav",
  "sad_M820.wav"
];

let idx = Math.floor(Math.random() * stimuli.length);
let audio = new Audio(`./stimuli/EMO_STIM_rvb/${stimuli[idx]}`);

document.getElementById("playBtn").onclick = () => audio.play();

document.querySelectorAll(".choice").forEach(btn => {
  btn.onclick = async () => {
    const emotion = btn.dataset.e;

    await fetch("YOUR_GOOGLE_APPS_SCRIPT_URL", {
      method: "POST",
      body: JSON.stringify({
        participant,
        stimulus: stimuli[idx],
        response: emotion,
        timestamp: Date.now()
      })
    });

    location.href = "done.html";
  };
});
</script>

</body>
</html>
